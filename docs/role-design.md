# Screeps 角色设计文档

## 目录
1. [Carry (搬运工)](#carry-搬运工)
2. [Worker (工人)](#worker-工人) 
3. [Harvester (采集者)](#harvester-采集者)
4. [Explorer (探索者)](#explorer-探索者)

## Carry (搬运工)

### 主要职责
- 在房间内运输能量和资源
- 为各种建筑补充能量
- 从各种来源收集资源

### 行为优先级
1. 紧急模式（塔能量低于50%）
   - 优先为防御塔补充能量
2. 常规模式
   - 为Spawn/Extension补充能量
   - 将资源存储到Storage
3. 收集模式
   - 从墓碑收集资源
   - 从废墟收集资源
   - 从Container收集资源

### 特殊处理
- 自动检测房间内能量分布
- 优先处理非能量资源的转移
- 根据建筑距离优化运输路线

### 行为流程图
[查看carry.drawio](../role/carry.drawio)

## Worker (工人)

### 主要职责
- 建造建筑
- 升级控制器
- 维修建筑
- 为建筑补充能量

### 行为优先级
1. 空背包时获取能量
2. 有能量时按以下优先级工作：
   - 补充Spawn/Extension能量
   - 控制器即将降级时优先升级
   - 修理受损建筑
   - 建造新建筑
   - 常规升级控制器

### 特殊处理
- 自动平衡工作任务分配
- 根据房间等级调整工作重点
- 智能选择能量来源

### 行为流程图
[查看worker.drawio](../role/worker.drawio)

## Harvester (采集者)

### 主要职责
- 持续采集能量源
- 将能量存储到指定Container

### 行为特点
1. 固定位置工作
   - 每个Harvester都有固定的Container和Source
2. 状态管理
   - 监控Source能量状态
   - 监控Container容量
3. 效率优化
   - Container满时暂停采集
   - Source空时等待重生

### 特殊处理
- 自动绑定最近的Container
- 智能等待能量重生
- 与其他Harvester协调工作

### 行为流程图
[查看harvester.drawio](../role/harvester.drawio)

## Explorer (探索者)

### 主要职责
- 探索未知房间
- 记录房间信息
- 寻找新的资源点

### 行为特点
1. 路径规划
   - 优先探索未访问的相邻房间
   - 记录已访问房间
2. 移动策略
   - 通过出口移动到相邻房间
   - 避开危险区域
3. 信息收集
   - 记录房间控制器状态
   - 记录资源点位置

### 特殊处理
- 自动规划探索路线
- 记录和更新房间信息
- 危险区域规避

### 行为流程图
[查看explorer.drawio](../role/explorer.drawio)

## 角色协作关系

### 资源链
1. Harvester采集能量 -> Container
2. Carry从Container运输 -> Storage/Spawn/Extension
3. Worker从Storage获取能量 -> 建造/升级/维修

### 任务分配
- 每个角色都有明确的分工
- 通过Memory共享信息
- 根据房间状态动态调整任务优先级

### 效率优化
- 固定工作位置减少移动消耗
- 智能路径规划减少拥堵
- 任务优先级动态调整

## 注意事项

### 性能优化
1. 减少不必要的寻路计算
2. 优化资源获取逻辑
3. 合理使用Memory缓存

### 容错处理
1. 处理creep死亡情况
2. 处理资源耗尽情况
3. 处理建筑损毁情况

### 扩展性
1. 预留角色扩展接口
2. 支持自定义任务优先级
3. 支持多房间协同工作 